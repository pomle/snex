<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SNEX - Minimal Example</title>

    <style type="text/css">
      body {
        font-family: monospace;
      }

      #hist {
        display: flex;
        flex-flow: column-reverse;
      }
    </style>

    <script src="http://cdn.peerjs.com/0.3/peer.min.js"></script>
    <script src="http://cdn.snex.io/dist/0.0.1/snex.js"></script>
  </head>
  <body>
    <div id="url"></div>

    <ul id="hist"></ul>

    <script type="text/javascript">
        const API_KEY = '5m8blh25pbzc9pb9';
        const peer = new Peer({key: API_KEY});

        peer.on('open', function(id) {
          const url = document.getElementById('url');
          const hist = document.getElementById('hist');

          snex.createSession(API_KEY, id, 'nes')
            .then(session => {
              url.textContent = session.url;
            });

          peer.on('connection', conn => {
            conn.on('data', data => {
              const item = document.createElement('li');
              item.textContent = JSON.stringify(data);
              hist.appendChild(item);
            });
          });
        });
    </script>
  </body>
</html>
